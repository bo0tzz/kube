apiVersion: apps/v1
kind: Deployment
metadata:
  name: youtube-sync
  namespace: media
  labels:
    app: youtube-sync
spec:
  selector:
      matchLabels:
        app: youtube-sync
  replicas: 1
  template:
    metadata:
      labels:
        app: youtube-sync
    spec:
      volumes:
        - name: library
          persistentVolumeClaim:
            claimName: youtube-library
      containers:
        - name: youtube-sync
          image: ghcr.io/bo0tzz/yt_emby_sync:main
          imagePullPolicy: Always
          volumeMounts:
            - name: library
              mountPath: /library
          env:
            - name: YT_PLAYLIST_URL
              value: https://www.youtube.com/playlist?list=PL3g5xwbQbHOQnjbZHQfeJW08PotvJ3JEh
            - name: DOWNLOAD_FOLDER
              value: /library
            - name: DESTRUCTIVE
              value: "true"
---
apiVersion: v1
kind: PersistentVolume
metadata:
  name: youtube-library
  namespace: media
spec:
  storageClassName: manual
  capacity:
    storage: 400G
  accessModes:
    - ReadWriteMany
  nfs:
    server: 192.168.2.10
    path: "/mnt/user/media/library/youtube"
---
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: youtube-library
  namespace: media
spec:
  storageClassName: manual
  volumeName: youtube-library
  accessModes:
    - ReadWriteMany
  resources:
    requests:
      storage: 400G
